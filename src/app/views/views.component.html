<nav class="navbar">
    <ul>
        <li>
            <img src="https://2handofficial.com/wp-content/uploads/2024/09/header-logo-2handofficial.png" alt="Logo" class="logo" />
        </li>
        <li><a (click)="fetchProducts()"><span class="material-icons">home</span>Trang Chủ</a></li>
        <li (mouseenter)="menDropdown = true" (mouseleave)="menDropdown = false">
            <a>
                <span class="material-icons">male</span>Thời Trang Nam
            </a>
            <ul class="dropdown-category" *ngIf="menDropdown">
                <li *ngFor="let category of menCategories">
                    <a (click)="menFashionItem(category)">{{ category }}</a>
                </li>
            </ul>
        </li>
        <li (mouseenter)="girlDropdown = true" (mouseleave)="girlDropdown = false">
            <a>
                <span class="material-icons">female</span>Thời Trang Nữ
            </a>
            <ul class="dropdown-category" *ngIf="girlDropdown">
                <li *ngFor="let category of girlCategories">
                    <a (click)="girlFashionItem(category)">{{ category }}</a>
                </li>
            </ul>
        </li>

        <li>
            <a (click)="showVoucher()" aria-label="Mã Giảm Giá">
                <span class="material-icons" aria-hidden="true">local_offer</span>
                <span>Mã Giảm Giá</span>
            </a>
        </li>
        <!-- <li><a routerLink="/about"><span class="material-icons">info</span>Giới Thiệu</a></li>
        <li><a routerLink="/contact"><span class="material-icons">contact_mail</span>Liên Hệ</a></li> -->
        <li>
            <a (click)="toggleCartModal()">
                <span class="material-icons">shopping_cart</span>
                <span class="cart-count" *ngIf="cartCount > 0">{{ cartCount }}</span>
            </a>
        </li>
        <li *ngIf="!user">
            <a routerLink="/login"><span class="material-icons">login</span>Đăng Nhập</a>
        </li>
        <li *ngIf="user" class="user-menu" (mouseover)="isHovered = true" (mouseleave)="isHovered = false">
            <a (click)="showInfo()" class="greeting" style="font-size: 16px; font-weight: bold">
                <span class="material-icons">person</span> Xin chào, {{ user.ten_dang_nhap }}
            </a>

            <div class="dropdown-content" *ngIf="isHovered">
                <ul>
                    <li>
                        <a routerLink="/admin/dashboard" *ngIf="isAdmin"><span class="material-icons">admin_panel_settings</span>Truy cập trang quản trị</a>
                    </li>
                    <li><a (click)="userActionsModal.openModal('updateInfo')"><span class="material-icons">edit</span>Cập nhật thông tin</a></li>
                    <li><a (click)="userActionsModal.openModal('changePassword')"><span class="material-icons">lock</span>Đổi mật khẩu</a></li>
                    <li><a (click)="userActionsModal.openModal('orderHistory')"><span class="material-icons">history</span>Lịch sử đơn hàng</a></li>
                    <li><a (click)="logout()"><span class="material-icons">logout</span>Đăng xuất</a></li>
                </ul>
            </div>
            <app-user-info #userActionsModal></app-user-info>
        </li>
    </ul>
</nav>


<!-- Thêm ảnh banner dưới thanh navbar -->
<div class="banner">
    <img src="https://media.canifa.com/Simiconnector/BannerSlider/s/p/spmoi_topbanner_desktop-30sep.webp" alt="Banner" class="banner-image" />
</div>

<!-- Tìm kiếm sản phẩm-->
<div class="search-container">
    <input type="text" placeholder="Tìm kiếm sản phẩm..." [(ngModel)]="searchTerm" />
    <button type="button" class="search-button" (click)="onSearch()">Tìm kiếm</button>
</div>

<!-- Gợi ý sản phẩm-->
<div class="product-container">
    <div class="product-container">
        <h3>Gợi Ý Sản Phẩm</h3>
        <div class="product-box">
            <div class="product-card" *ngFor="let product of filteredProducts | slice:0:displayedProductsCount" (click)="openProductDetail(product)">
                <img [src]="product.anh_san_pham || 'default-image-url.jpg'" alt="{{ product.ten_san_pham }}" class="product-image" />
                <div class="product-name">
                    {{ product.ten_san_pham }}
                </div>
                <div class="product-price">{{ product.gia_ban | currency:'VND' }}</div>
                <div class="product-info">
                    <span class="sold">Đã bán: {{ product.da_ban }}</span>
                    <span class="stock">Tồn kho: {{ product.ton_kho }}</span>
                </div>
            </div>
            <button *ngIf="filteredProducts.length > displayedProductsCount" (click)="loadMoreProducts()">
          Bạn muốn xem thêm
      </button>
            <button *ngIf="displayedProductsCount > 18" (click)="hideProducts()">
          Ẩn bớt
      </button>

        </div>
    </div>


    <div class="product-container" *ngIf="isMenProduct">
        <h3>Thời Trang Nam</h3>
        <div class="product-box">
            <div class="product-card" *ngFor="let product of menProducts | slice:0:displayedProductsCount" (click)="openProductDetail(product)">
                <img [src]="product.anh_san_pham || 'default-image-url.jpg'" alt="{{ product.ten_san_pham }}" class="product-image" />
                <div class="product-name">
                    {{ product.ten_san_pham }}
                </div>
                <div class="product-price">{{ product.gia_ban | currency:'VND' }}</div>
                <div class="product-info">
                    <span class="sold">Đã bán: {{ product.da_ban }}</span>
                    <span class="stock">Tồn kho: {{ product.ton_kho }}</span>
                </div>
            </div>
            <button *ngIf="menProducts.length > displayedProductsCount" (click)="loadMoreProducts()">
            Bạn muốn xem thêm
        </button>
            <button *ngIf="displayedProductsCount > 18" (click)="hideProducts()">
            Ẩn bớt
        </button>

        </div>
    </div>

    <div class="product-container" *ngIf="isGirlProduct">
        <h3>Thời Trang Nữ</h3>
        <div class="product-box">
            <div class="product-card" *ngFor="let product of girlProducts | slice:0:displayedProductsCount" (click)="openProductDetail(product)">
                <img [src]="product.anh_san_pham || 'default-image-url.jpg'" alt="{{ product.ten_san_pham }}" class="product-image" />
                <div class="product-name">
                    {{ product.ten_san_pham }}
                </div>
                <div class="product-price">{{ product.gia_ban | currency:'VND' }}</div>
                <div class="product-info">
                    <span class="sold">Đã bán: {{ product.da_ban }}</span>
                    <span class="stock">Tồn kho: {{ product.ton_kho }}</span>
                </div>
            </div>
            <button *ngIf="girlProducts.length > displayedProductsCount" (click)="loadMoreProducts()">
          Bạn muốn xem thêm
      </button>
            <button *ngIf="displayedProductsCount > 18" (click)="hideProducts()">
          Ẩn bớt
      </button>

        </div>
    </div>

    <app-product-detail-modal [product]="selectedProduct" *ngIf="isSelectedProduct" (closeModal)="onCloseModal()" (addCart)="addToCart($event)" (onBuyNow)="buyNow($event)">
    </app-product-detail-modal>

    <app-cart-modal *ngIf="isOpenModalCart" [cartItems]="cartItems" [isOpen]="isOpenModalCart" (close)="closeCart()" (removeItem)="handleRemoveItem($event)"></app-cart-modal>

    <app-voucher *ngIf="isVoucherModalVisible" (closeModalEvent)="closeVoucherModal()"></app-voucher>

</div>